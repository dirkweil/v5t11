<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
  xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:p="http://primefaces.org/ui">

<ui:composition template="/WEB-INF/templates/v5t11.xhtml">
  <ui:param name="title" value="System Control" />

  <ui:define name="content">
    <h:form prependId="false">
      <p:growl id="msgs" showDetail="true" />

      <p:fieldset legend="Allgemein">
        <h:panelGrid columns="2">
          <p:outputLabel for="gleisspannung" value="Gleisspannung: " />
          <p:selectBooleanButton id="gleisspannung" value="#{systemControlPresenter.gleisspannung}" onLabel="an" offLabel="aus" style="width:60px">
            <p:ajax />
          </p:selectBooleanButton>
        </h:panelGrid>
      </p:fieldset>

      <p:fieldset legend="Fahrweg">
        <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="5">
          <p:outputLabel for="bereich" value="Bereich:" />
          <p:selectOneMenu id="bereich" value="#{systemControlPresenter.bereich}" style="width:125px">
            <f:selectItems value="#{systemControlPresenter.bereiche}" />
            <p:ajax event="itemSelect" update="weiche signal" />
          </p:selectOneMenu>

          <p:outputLabel for="weiche" value="Weiche:" />
          <h:panelGroup id="weiche">
            <p:selectOneMenu value="#{systemControlPresenter.weichenName}" style="width:125px">
              <f:selectItems value="#{systemControlPresenter.weichen}" var="weiche" itemLabel="#{weiche.name}" itemValue="#{weiche.name}" />
              <p:ajax event="itemSelect" update="weiche" />
            </p:selectOneMenu>
            <p:selectOneButton value="#{systemControlPresenter.weichenStellung}">
              <f:selectItems value="#{systemControlPresenter.weichenStellungen}" />
              <p:ajax />
            </p:selectOneButton>
          </h:panelGroup>

          <p:outputLabel for="signal" value="Signal:" />
          <h:panelGroup id="signal">
            <p:selectOneMenu value="#{systemControlPresenter.signalName}" style="width:125px">
              <f:selectItems value="#{systemControlPresenter.signale}" var="signal" itemLabel="#{signal.name}" itemValue="#{signal.name}" />
              <p:ajax event="itemSelect" update="signal" />
            </p:selectOneMenu>
            <p:selectOneButton value="#{systemControlPresenter.signalStellung}">
              <f:selectItems value="#{systemControlPresenter.signalStellungen}" />
              <p:ajax />
            </p:selectOneButton>
          </h:panelGroup>

        </h:panelGrid>
      </p:fieldset>

      <p:fieldset id="lok" legend="Lok">
        <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="5">
          <p:outputLabel for="lokIdAktiv" value="Lok:" />
          <h:panelGroup id="lokIdAktiv">
            <p:selectOneMenu id="lokId" value="#{systemControlPresenter.lokId}" style="width:125px">
              <f:selectItems value="#{systemControlPresenter.loks}" var="lok" itemLabel="#{lok.id}" itemValue="#{lok.id}" />
              <p:ajax event="itemSelect" update="lok" />
            </p:selectOneMenu>
            <p:selectBooleanButton id="lokAktiv" value="#{systemControlPresenter.lokAktiv}" onLabel="aktiv" offLabel="inaktiv" style="width:120px">
              <p:ajax />
            </p:selectBooleanButton>
          </h:panelGroup>

          <p:outputLabel for="lokFahrstufe" value="Fahrstufe:" />
          <h:panelGrid id="lokFahrstufe" columns="2">
            <p:inputText id="fahrstufe" value="#{systemControlPresenter.lokFahrstufe}" />
            <p:selectBooleanButton id="lokRueckwaerts" value="#{systemControlPresenter.lokRueckwaerts}" onLabel="rückwärts" offLabel="vorwärts" style="width:120px">
              <p:ajax />
            </p:selectBooleanButton>
            <p:slider for="fahrstufe" minValue="0" maxValue="#{systemControlPresenter.lokMaxFahrstufe}">
              <p:ajax process="fahrstufe" />
            </p:slider>
          </h:panelGrid>

          <c:forEach items="#{systemControlPresenter.lokFunktionConfigGruppen}" var="lfcg">
            <p:outputLabel value="#{lfcg.name}:" />
            <h:panelGroup >
              <c:forEach items="#{systemControlPresenter.getLokFunktionConfigs(lfcg)}" var="fc">
                <p:selectBooleanButton onLabel="#{fc.beschreibung}" offLabel="#{fc.beschreibung}" value="#{fc.aktiv}">
                  <p:ajax update="lok"/>
                </p:selectBooleanButton>
              </c:forEach>
            </h:panelGroup>
          </c:forEach>
        </h:panelGrid>
      </p:fieldset>
    </h:form>

    <h:form>
      <p:commandButton ajax="false" value="refresh" icon="fa fa-refresh" />
    </h:form>

  </ui:define>
</ui:composition>
</html>
