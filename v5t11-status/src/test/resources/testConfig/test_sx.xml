<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<sx>
  <!-- <DummyZentrale/> -->
  <FCC />

  <Besetztmelder>
    <BMMiba3 id="BM-1" adr="90" einbauOrt="neben Interface">
      <Gleis idx="0" bereich="show" name="W1" />
      <Gleis idx="1" bereich="show" name="S" />
      <Gleis idx="2" bereich="show" name="W3" />
      <Gleis idx="3" bereich="show" name="2" />
      <Gleis idx="4" bereich="show" name="W2" />
      <Gleis idx="5" bereich="show" name="11" />
      <Gleis idx="6" bereich="show" name="12" />
      <Gleis idx="7" bereich="show" name="1" />
    </BMMiba3>

    <BMMiba3 id="BM-2" adr="91" einbauOrt="nur zum Test">
      <Gleis idx="0" bereich="test" name="1" />
      <Gleis idx="1" bereich="test" name="2" />
      <Gleis idx="2" bereich="test" name="3" />
      <Gleis idx="3" bereich="test" name="4" />
      <Gleis idx="4" bereich="test" name="5" />
      <Gleis idx="5" bereich="test" name="6" />
      <Gleis idx="6" bereich="test" name="7" />
      <Gleis idx="7" bereich="test" name="8" />
    </BMMiba3>

    <BMMiba3 id="BM-3" adr="92" einbauOrt="nur zum Test der Kehrschleifenschaltung">
      <Gleis idx="0" bereich="SBf" name="17a" />
      <Gleis idx="1" bereich="SBf" name="17b" />
      <Gleis idx="2" bereich="SBf" name="17c" />
      <Gleis idx="3" bereich="SBf" name="17d" />
      <Gleis idx="4" bereich="SBf" name="18a" />
      <Gleis idx="5" bereich="SBf" name="18b" />
      <Gleis idx="6" bereich="SBf" name="18c" />
      <Gleis idx="7" bereich="SBf" name="109" />
    </BMMiba3>
  </Besetztmelder>

  <Funktionsdecoder>
    <WDMiba3 id="FD-1" adr="80" einbauOrt="neben Trafo">
      <Weiche idx="1" bereich="show" name="3" />
      <Weiche idx="2" bereich="show" name="2" />
      <Weiche idx="3" bereich="show" name="1" />
      <HauptsignalRtGnGe idx="4" bereich="show" name="F" dauer="true" />
      <HauptsignalRtGe idx="6" bereich="show" name="N1" dauer="true" />
      <HauptsignalRtGn idx="7" bereich="show" name="N2" dauer="true" />
    </WDMiba3>

    <SXSD1 id="FD-2" adr="81" einbauOrt="nur zum Test">
      <Hauptsperrsignal idx="0" bereich="test" name="P2" />
      <Hauptsperrsignal idx="2" bereich="test" name="P3" />
      <Hauptsperrsignal idx="4" bereich="test" name="P4" />
      <Weiche idx="6" bereich="test" name="10" />
      <Weiche idx="7" bereich="test" name="11" />
      <Vorsignal idx="8" bereich="test" name="2a" />
      <Vorsignal idx="10" bereich="test" name="2b" />
      <HauptsignalRtGnGe idx="12" bereich="test" name="A" />
      <HauptsignalRtGe idx="14" bereich="test" name="B" />
      <HauptsignalRtGn idx="15" bereich="test" name="C" />
    </SXSD1>

    <WDMiba3 id="FD-3" adr="83" einbauOrt="nur zum Test der Kehrschleifenschaltung">
      <Schalter idx="0" bereich="SBf" name="KS18" />
      <Schalter idx="1" bereich="SBf" name="KS17" />
    </WDMiba3>

    <NoFD id="dummy-1">
      <Weiche idx="0" bereich="test" name="99" />
      <HauptsignalRtGe idx="1" bereich="test" name="X" />
    </NoFD>
  </Funktionsdecoder>

  <!--
    <Lokdecoder>
    <Tr66825 id="LD-1" adr="5" lok="212 216-6" />
    <DHL100 id="LD-2" adr="6" lok="VT 98.9731" />
    </Lokdecoder>
  -->

  <Lokcontroller>
    <SxLokControl id="LokControl 1" adr="30" />
    <SxLokControl id="LokControl 2" adr="31" />
  </Lokcontroller>

  <AutoSkripte>
    <AutoSkript bereich="SBf" beschreibung="Polung Wendestrecke 17">
      <Gleis name="109" />
      <Gleis name="17a" />
      <Gleis name="17b" />
      <Gleis name="17c" />
      <Gleis name="17d" />
      <Schalter name="KS17" />
      <Skript sprache="groovy">
        if (gleis17c.isBesetzt() || gleis17d.isBesetzt()) {
          log.debug("Polung KS17: links");
          schalterKS17.setStellung(EIN);
        } else if (gleis109.isBesetzt() || gleis17a.isBesetzt()) {
          log.debug("Polung KS17: rechts");
          schalterKS17.setStellung(AUS);
        }
      </Skript>
    </AutoSkript>

    <AutoSkript bereich="SBf" beschreibung="Polung Wendestrecke 18">
      <Gleis name="18a" />
      <Gleis name="18b" />
      <Gleis name="18c" />
      <Schalter name="KS18" />
      <Skript sprache="groovy">
        if (gleis18c.isBesetzt()) {
          log.debug("Polung KS18: links");
          schalterKS18.setStellung(EIN);
        } else if (gleis18a.isBesetzt()) {
          log.debug("Polung KS18: rechts");
          schalterKS18.setStellung(AUS);
        }
      </Skript>
    </AutoSkript>
  </AutoSkripte>

</sx>

