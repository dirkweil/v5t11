<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<ui:composition template="/WEB-INF/templates/leitstand.xhtml">
  <ui:param name="title" value="Stellwerk ${stellwerkPresenter.stellwerk.bereich}"/>
  <ui:define name="content">
    <p:remoteCommand name="elementClicked" action="${stellwerkPresenter.elementClicked}"/>
    <div class="stellwerk">
      <ui:repeat var="zeile" value="${stellwerkPresenter.stellwerk.zeilen}">
        <ui:repeat var="element" value="${zeile.elemente}">
          <canvas id="${element.uiId}"
                  style="grid-row-start: ${element.zeilenNr}; grid-column-start: ${element.spaltenNr};"
                  onclick="elementClicked([{name:'uiId', value:'${element.uiId}'}])">
          </canvas>
        </ui:repeat>
      </ui:repeat>
    </div>

    <h:outputStylesheet name="stellwerk.css"/>

    <f:phaseListener type="de.gedoplan.v5t11.leitstand.webui.DemoPhaseListener"/>

    <f:websocket channel="stellwerk" onmessage="updateElement"/>

    <script>
      function updateElement(message) {
        console.log('updateElement: ' + JSON.stringify(message));
      }
    </script>
  </ui:define>
</ui:composition>
</html>
